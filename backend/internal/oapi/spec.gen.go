// Package oapi provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.4.1 DO NOT EDIT.
package oapi

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
	"b5bfLKPmVPN/AQAA//8uk2mgCCcAAA==",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
