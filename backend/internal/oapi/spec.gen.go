// Package oapi provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.4.1 DO NOT EDIT.
package oapi

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
