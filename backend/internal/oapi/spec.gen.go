// Package oapi provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.4.1 DO NOT EDIT.
package oapi

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
