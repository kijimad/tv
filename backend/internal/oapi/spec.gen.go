// Package oapi provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.4.1 DO NOT EDIT.
package oapi

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
