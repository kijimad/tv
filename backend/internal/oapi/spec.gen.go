// Package oapi provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.4.1 DO NOT EDIT.
package oapi

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
	"AP//9OltoBQkAAA=",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
